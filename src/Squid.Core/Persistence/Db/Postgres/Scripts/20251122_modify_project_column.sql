ALTER TABLE project DROP COLUMN cloned_from_project_id;
ALTER TABLE project ADD COLUMN cloned_from_project_id INTEGER;

ALTER TABLE "deployment" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "deployment" ALTER COLUMN task_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ALTER COLUMN channel_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ALTER COLUMN project_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ALTER COLUMN release_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ALTER COLUMN environment_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment" ADD COLUMN IF NOT EXISTS process_snapshot_id INTEGER;
ALTER TABLE "deployment" ADD COLUMN IF NOT EXISTS variable_snapshot_id INTEGER;
ALTER TABLE "deployment" ALTER COLUMN deployed_to_machine_ids SET DEFAULT '';
UPDATE "deployment" SET deployed_to_machine_ids = '' WHERE deployed_to_machine_ids IS NULL;

ALTER TABLE "deployment_environment" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment_environment" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "space" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "space" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;

ALTER TABLE "release" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "release" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "release" ALTER COLUMN project_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "release" ALTER COLUMN project_variable_set_snapshot_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "release" ALTER COLUMN project_deployment_process_snapshot_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "release" ALTER COLUMN channel_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "release" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "release" ALTER COLUMN json SET DEFAULT '';
UPDATE "release" SET json = '' WHERE json IS NULL;
ALTER TABLE "release" ALTER COLUMN data_version SET DEFAULT E'\\x00000000000000000000000000000000';
UPDATE "release" SET data_version = E'\\x00000000000000000000000000000000' WHERE data_version IS NULL;

ALTER TABLE "deployment_process" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment_process" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "deployment_process" ALTER COLUMN project_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment_process" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment_process" ALTER COLUMN is_frozen SET DEFAULT FALSE;
UPDATE "deployment_process" SET is_frozen = FALSE WHERE is_frozen IS NULL;



ALTER TABLE "channel" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "channel" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "channel" ALTER COLUMN project_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "channel" ALTER COLUMN lifecycle_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "channel" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE project ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE project ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE project ALTER COLUMN variable_set_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE project ALTER COLUMN deployment_process_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE project ALTER COLUMN project_group_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE project ALTER COLUMN lifecycle_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE project ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "library_variable_set" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "library_variable_set" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "library_variable_set" ALTER COLUMN variable_set_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "library_variable_set" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "machine" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "machine" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "machine" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "deployment_completion" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment_completion" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "deployment_completion" ALTER COLUMN deployment_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "deployment_completion" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "server_task" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "server_task" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "server_task" ALTER COLUMN project_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "server_task" ALTER COLUMN environment_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "server_task" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "server_task" ALTER COLUMN parent_server_task_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "server_task" ALTER COLUMN batch_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "server_task" ADD COLUMN IF NOT EXISTS json TEXT;
ALTER TABLE "server_task" ALTER COLUMN data_version SET DEFAULT E'\\x00000000000000000000000000000000';
UPDATE "server_task" SET data_version = E'\\x00000000000000000000000000000000' WHERE data_version IS NULL;

ALTER TABLE "lifecycle" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "lifecycle" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "lifecycle" ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "lifecycle" ALTER COLUMN release_retention_policy_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "lifecycle" ALTER COLUMN tentacle_retention_policy_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "phase" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "phase" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE "phase" ALTER COLUMN lifecycle_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "phase" ALTER COLUMN release_retention_policy_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "phase" ALTER COLUMN tentacle_retention_policy_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE "retention_policy" ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE "retention_policy" ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;

ALTER TABLE external_feed ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE external_feed ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE external_feed ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE environment ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE environment ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE environment ALTER COLUMN space_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE deployment_step ALTER COLUMN id DROP DEFAULT;
ALTER TABLE deployment_step ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE deployment_step ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE deployment_step ALTER COLUMN process_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE deployment_step_property ALTER COLUMN step_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE deployment_action ALTER COLUMN id DROP DEFAULT;
ALTER TABLE deployment_action ALTER COLUMN id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE deployment_action ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY;
ALTER TABLE deployment_action ALTER COLUMN step_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE deployment_action ALTER COLUMN worker_pool_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE deployment_action_property ALTER COLUMN action_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE action_environments ALTER COLUMN action_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE action_environments ALTER COLUMN environment_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE action_channels ALTER COLUMN action_id TYPE INTEGER USING NULL::INTEGER;
ALTER TABLE action_channels ALTER COLUMN channel_id TYPE INTEGER USING NULL::INTEGER;

ALTER TABLE action_machine_roles ALTER COLUMN action_id TYPE INTEGER USING NULL::INTEGER;
